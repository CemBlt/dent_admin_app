{% extends 'panel/base.html' %}
{% load static %}

{% block extra_css %}
    <link rel="stylesheet" href="{% static 'panel/schedule.css' %}">
{% endblock %}

{% block top_bar_subtitle %}Takvim Yönetimi{% endblock %}

{% block top_bar_title %}{{ page_title }} - {{ calendar.month_name }} {{ calendar.year }}{% endblock %}

{% block content %}

    <section class="panel-card">
        <h2>Filtreler</h2>
        <form method="get" class="filter-form">
            {{ filter_form.as_p }}
            <button type="submit" class="primary">Göster</button>
        </form>
    </section>

    <section class="panel-card">
        <h2>Takvim</h2>
        <div class="calendar-grid">
            <div class="calendar-header">
                <div>Pzt</div>
                <div>Sal</div>
                <div>Çar</div>
                <div>Per</div>
                <div>Cum</div>
                <div>Cmt</div>
                <div>Paz</div>
            </div>
            {% for week in calendar.weeks %}
                <div class="calendar-week">
                    {% for day in week %}
                        <div class="calendar-day {% if not day.is_current_month %}other-month{% endif %} {% if day.is_today %}today{% endif %} {% if day.is_past %}past{% endif %}">
                            <div class="day-number">{{ day.date.day }}</div>
                            {% if day.hospital_hours %}
                                <div class="hours-badge hospital {% if day.has_full_day_holiday %}cancelled{% endif %}">H: {{ day.hospital_hours }}</div>
                            {% endif %}
                            {% if day.doctor_hours %}
                                <div class="hours-badge doctor {% if day.has_full_day_holiday %}cancelled{% endif %}">D: {{ day.doctor_hours }}</div>
                            {% endif %}
                            {% for holiday in day.holidays %}
                                <div class="holiday-badge">{{ holiday.reason }}</div>
                            {% endfor %}
                        </div>
                    {% endfor %}
                </div>
            {% endfor %}
        </div>
    </section>

    <section class="panel-card">
        <h2>Yeni Tatil Ekle</h2>
        <form method="post">
            {% csrf_token %}
            <input type="hidden" name="form_type" value="add_holiday">
            {{ holiday_form.as_p }}
            <button type="submit" class="primary">Tatil Ekle</button>
        </form>
    </section>
{% endblock %}

